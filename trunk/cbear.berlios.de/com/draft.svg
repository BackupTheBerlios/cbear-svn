<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://web.resource.org/cc/"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://inkscape.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="744.09448819"
   height="1052.3622047"
   id="svg2"
   sodipodi:version="0.32"
   inkscape:version="0.42"
   sodipodi:docbase="C:\cbear\cbear.berlios.de\com"
   sodipodi:docname="draft.svg">
  <defs
     id="defs4" />
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="0.98994949"
     inkscape:cx="375.00000"
     inkscape:cy="520.00000"
     inkscape:document-units="px"
     inkscape:current-layer="layer1"
     inkscape:window-width="1170"
     inkscape:window-height="1003"
     inkscape:window-x="-4"
     inkscape:window-y="-4" />
  <metadata
     id="metadata7">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1">
    <rect
       style="fill:#ffffd4;fill-opacity:1.0000000;stroke:#ff0000;stroke-width:0.95513070;stroke-miterlimit:4.0000000;stroke-dasharray:0.95513071 2.8653920;stroke-dashoffset:0.00000000;stroke-opacity:1.0000000"
       id="rect2849"
       width="664.77460"
       height="155.54396"
       x="16.115334"
       y="152.32603" />
    <rect
       style="fill:#ffffd4;fill-opacity:1.0000000;stroke:#ff0000;stroke-width:0.95513070;stroke-miterlimit:4.0000000;stroke-dasharray:0.95513071 2.8653920;stroke-dashoffset:0.00000000;stroke-opacity:1.0000000"
       id="rect3577"
       width="664.77460"
       height="155.54396"
       x="24.196550"
       y="650.33118" />
    <text
       xml:space="preserve"
       style="font-size:12.000000px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1.0000000;stroke:none;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000;font-family:Bitstream Vera Sans"
       x="59.598999"
       y="223.02695"
       id="text1306"><tspan
         sodipodi:role="line"
         id="tspan1308"
         x="59.598999"
         y="223.02695">class A: public IUnknown</tspan><tspan
         sodipodi:role="line"
         x="59.598999"
         y="238.02695"
         id="tspan1338">{</tspan><tspan
         sodipodi:role="line"
         x="59.598999"
         y="253.02695"
         id="tspan2839">public:</tspan><tspan
         sodipodi:role="line"
         x="59.598999"
         y="268.02695"
         id="tspan1378">  virtual int F() = 0;</tspan><tspan
         sodipodi:role="line"
         x="59.598999"
         y="283.02695"
         id="tspan1342">};</tspan><tspan
         sodipodi:role="line"
         x="59.598999"
         y="298.02695"
         id="tspan1336" /><tspan
         sodipodi:role="line"
         x="59.598999"
         y="313.02695"
         id="tspan1334" /></text>
    <text
       xml:space="preserve"
       style="font-size:12.000000px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1.0000000;stroke:none;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000;font-family:Bitstream Vera Sans"
       x="440.42651"
       y="184.64114"
       id="text1310"><tspan
         sodipodi:role="line"
         id="tspan1312"
         x="440.42651"
         y="184.64114">class B: public IUnknown</tspan><tspan
         sodipodi:role="line"
         x="440.42651"
         y="199.64114"
         id="tspan1344">{</tspan><tspan
         sodipodi:role="line"
         x="440.42651"
         y="214.64114"
         id="tspan2837">public:</tspan><tspan
         sodipodi:role="line"
         x="440.42651"
         y="229.64114"
         id="tspan1346">  virtual int F() = 0;</tspan><tspan
         sodipodi:role="line"
         x="440.42651"
         y="244.64114"
         id="tspan1348">};</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:12.000000px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1.0000000;stroke:none;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000;font-family:Bitstream Vera Sans"
       x="126.26907"
       y="134.13351"
       id="text1314"><tspan
         sodipodi:role="line"
         x="126.26907"
         y="134.13351"
         id="tspan1357">class IUnknown</tspan></text>
    <path
       style="fill:none;fill-opacity:0.75000000;fill-rule:evenodd;stroke:#000000;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000"
       d="M 88.893424,207.87465 L 144.45181,143.22489"
       id="path1318" />
    <path
       style="fill:none;fill-opacity:0.75000000;fill-rule:evenodd;stroke:#000000;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000"
       d="M 187.88837,140.19443 L 432.34529,173.52946"
       id="path1320"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:12.000000px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1.0000000;stroke:none;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000;font-family:Bitstream Vera Sans"
       x="21.213203"
       y="508.90009"
       id="text1322"><tspan
         sodipodi:role="line"
         id="tspan1324"
         x="21.213203"
         y="508.90009">class Wrap&lt;A&gt;: public A, public Base</tspan><tspan
         sodipodi:role="line"
         x="21.213203"
         y="523.90009"
         id="tspan1350">{</tspan><tspan
         sodipodi:role="line"
         x="21.213203"
         y="538.90009"
         id="tspan2843">public:</tspan><tspan
         sodipodi:role="line"
         x="21.213203"
         y="553.90009"
         id="tspan1376">  Wrap() { Base::add_interface(uuid::of(A), this); }</tspan><tspan
         sodipodi:role="line"
         x="21.213203"
         y="568.90009"
         id="tspan2097">  virtual A_F() = 0;</tspan><tspan
         sodipodi:role="line"
         x="21.213203"
         y="583.90009"
         id="tspan1358">  int F() { return A_F(); }</tspan><tspan
         sodipodi:role="line"
         x="21.213203"
         y="598.90009"
         id="tspan1352">};</tspan></text>
    <path
       style="fill:none;fill-opacity:0.75000000;fill-rule:evenodd;stroke:#000000;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000"
       d="M 89.903576,274.54472 L 69.700524,492.73767"
       id="path1326"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:0.75000000;fill-rule:evenodd;stroke:#000000;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000"
       d="M 520.22856,469.50416 L 487.90368,233.12847"
       id="path1328"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:12.000000px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1.0000000;stroke:none;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000;font-family:Bitstream Vera Sans"
       x="419.21329"
       y="484.65643"
       id="text1330"><tspan
         sodipodi:role="line"
         id="tspan1332"
         x="419.21329"
         y="484.65643">class Wrap&lt;B&gt;: public B, public Base</tspan><tspan
         sodipodi:role="line"
         x="419.21329"
         y="499.65643"
         id="tspan1362">{</tspan><tspan
         sodipodi:role="line"
         x="419.21329"
         y="514.65643"
         id="tspan2845">public:</tspan><tspan
         sodipodi:role="line"
         x="419.21329"
         y="529.65643"
         id="tspan1374">  Wrap() { Base::add_interface(uuid::of(B), this); }</tspan><tspan
         sodipodi:role="line"
         x="419.21329"
         y="544.65643"
         id="tspan2099">  virtual int B_F() = 0;</tspan><tspan
         sodipodi:role="line"
         x="419.21329"
         y="559.65643"
         id="tspan1370">  int F() { return B_F(); }</tspan><tspan
         sodipodi:role="line"
         x="419.21329"
         y="574.65643"
         id="tspan1364">};</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:12.000000px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1.0000000;stroke:none;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000;font-family:Bitstream Vera Sans"
       x="201.02036"
       y="327.07266"
       id="text1380"><tspan
         sodipodi:role="line"
         id="tspan1382"
         x="201.02036"
         y="327.07266">virtual class Base</tspan><tspan
         sodipodi:role="line"
         x="201.02036"
         y="342.07266"
         id="tspan1384">{</tspan><tspan
         sodipodi:role="line"
         x="201.02036"
         y="357.07266"
         id="tspan2101">public:</tspan><tspan
         sodipodi:role="line"
         x="201.02036"
         y="372.07266"
         id="tspan1359">  int AddRef();</tspan><tspan
         sodipodi:role="line"
         x="201.02036"
         y="387.07266"
         id="tspan1390">  int Release();</tspan><tspan
         sodipodi:role="line"
         x="201.02036"
         y="402.07266"
         id="tspan2107">  HRESULT QueryInterface(::UUID, void**);</tspan><tspan
         sodipodi:role="line"
         x="201.02036"
         y="417.07266"
         id="tspan2103">protected:</tspan><tspan
         sodipodi:role="line"
         x="201.02036"
         y="432.07266"
         id="tspan1367">  void add_interface(uuid, void *);</tspan><tspan
         sodipodi:role="line"
         x="201.02036"
         y="447.07266"
         id="tspan1386">};</tspan></text>
    <path
       style="fill:#000000;fill-opacity:1.0000000;fill-rule:evenodd;stroke:#000000;stroke-width:1.0000000;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000;stroke-miterlimit:4.0000000;stroke-dasharray:1.0000000,2.0000000;stroke-dashoffset:0.00000000"
       d="M 188.89852,416.97623 L 105.05586,490.71737"
       id="path1392"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:0.75000000;fill-rule:evenodd;stroke:#000000;stroke-width:1.0000000;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4.0000000;stroke-dasharray:1.0000000 2.0000000 ;stroke-dashoffset:0.00000000;stroke-opacity:1.0000000"
       d="M 425.27422,428.08792 L 505.07627,468.49402"
       id="path3572"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:12.000000px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1.0000000;stroke:none;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000;font-family:Bitstream Vera Sans"
       x="234.35539"
       y="693.75806"
       id="text4302"><tspan
         sodipodi:role="line"
         id="tspan4304"
         x="234.35539"
         y="693.75806">class Implementation: wrap&lt;A&gt;, wrap&lt;B&gt;</tspan><tspan
         sodipodi:role="line"
         x="234.35539"
         y="708.75806"
         id="tspan4306">{</tspan><tspan
         sodipodi:role="line"
         x="234.35539"
         y="723.75806"
         id="tspan4310">  int A_F() { return 1; }</tspan><tspan
         sodipodi:role="line"
         x="234.35539"
         y="738.75806"
         id="tspan4312">  int B_F() { return 2; }</tspan><tspan
         sodipodi:role="line"
         x="234.35539"
         y="753.75806"
         id="tspan4308">};</tspan></text>
    <path
       style="fill:none;fill-opacity:0.75000000;fill-rule:evenodd;stroke:#000000;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000"
       d="M 145.46197,598.80369 L 287.89348,678.60574"
       id="path4314"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:0.75000000;fill-rule:evenodd;stroke:#000000;stroke-width:1.0000000px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000"
       d="M 459.61941,580.62093 L 372.74629,674.56513"
       id="path4316"
       sodipodi:nodetypes="cc" />
  </g>
</svg>
